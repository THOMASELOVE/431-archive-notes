<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Archived Course Notes for 431, version 2023 - 24&nbsp; Analysis of Variance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./25-one_proportion.html" rel="next">
<link href="./23-examples_2means.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./18-testing_intro.html">Part B. Comparing Summaries</a></li><li class="breadcrumb-item"><a href="./24-anova.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Archived Course Notes for 431, version 2023</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="./431-archive-notes.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">This is the archived version of Dr.&nbsp;Love’s Course Notes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./int_r_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setting Up R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-datascience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Data Science and 431</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Part A. Exploring Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-penguins1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Palmer Penguins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-penguins2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summarizing Penguins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-nhanes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NHANES Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Types of Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-nhanes_cc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">More NHANES Summaries</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-summarizing_quantities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Summarizing Quantities</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-summarizing_categories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summarizing Categories</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-missing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Missing Data and Single Imputation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-nnyfs_foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">National Youth Fitness Survey</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-normality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Assessing Normality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-straightlinemodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Straight Line Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-linear_trans.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Linearizing Transformations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-crabs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Studying Crab Claws</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-hydrate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Dehydration Recovery</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-wcgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The WCGS</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part B. Comparing Summaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-testing_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Hypothesis Testing: What is it good for?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-ci_for_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Confidence Intervals for a Mean</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-ibuprofen_sepsis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Ibuprofen in Sepsis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-pairedsamples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Comparing Means with Paired Samples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Sample Size and Power for Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-examples_2means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Two Examples Comparing Means</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Estimating a Population Proportion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26-comparing_rates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Comparing Proportions with Two Independent Samples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27-power_for_rates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Power and Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./28-contingency_tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Larger Contingency Tables</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part C. Building Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./29-mult_reg_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Multiple Regression: Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30-regr_diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Regression Diagnostics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31-prediction_wcgs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Building Prediction Models for <code>wcgs</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32-galapagos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Species Found on the Galapagos Islands</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33-nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Introduction to Non-linear Terms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34-olsfits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Using <code>ols</code> to fit linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./35-emp_bmi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">BMI and Employment Study</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98_gettingdataintoR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Getting Data Into R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99_sessioninfo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Session Information</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#setup-packages-used-here" id="toc-setup-packages-used-here" class="nav-link active" data-scroll-target="#setup-packages-used-here"><span class="header-section-number">24.1</span> Setup: Packages Used Here</a></li>
  <li><a href="#national-youth-fitness-survey" id="toc-national-youth-fitness-survey" class="nav-link" data-scroll-target="#national-youth-fitness-survey"><span class="header-section-number">24.2</span> National Youth Fitness Survey</a></li>
  <li><a href="#comparing-gross-motor-quotient-scores-by-income-level-3-categories" id="toc-comparing-gross-motor-quotient-scores-by-income-level-3-categories" class="nav-link" data-scroll-target="#comparing-gross-motor-quotient-scores-by-income-level-3-categories"><span class="header-section-number">24.3</span> Comparing Gross Motor Quotient Scores by Income Level (3 Categories)</a></li>
  <li>
<a href="#alternative-procedures-for-comparing-more-than-two-means" id="toc-alternative-procedures-for-comparing-more-than-two-means" class="nav-link" data-scroll-target="#alternative-procedures-for-comparing-more-than-two-means"><span class="header-section-number">24.4</span> Alternative Procedures for Comparing More Than Two Means</a>
  <ul class="collapse">
<li><a href="#extending-the-welch-test-to-2-independent-samples" id="toc-extending-the-welch-test-to-2-independent-samples" class="nav-link" data-scroll-target="#extending-the-welch-test-to-2-independent-samples"><span class="header-section-number">24.4.1</span> Extending the Welch Test to &gt; 2 Independent Samples</a></li>
  <li><a href="#extending-the-rank-sum-test-to-2-independent-samples" id="toc-extending-the-rank-sum-test-to-2-independent-samples" class="nav-link" data-scroll-target="#extending-the-rank-sum-test-to-2-independent-samples"><span class="header-section-number">24.4.2</span> Extending the Rank Sum Test to &gt; 2 Independent Samples</a></li>
  <li><a href="#can-we-use-the-bootstrap-to-compare-more-than-two-means" id="toc-can-we-use-the-bootstrap-to-compare-more-than-two-means" class="nav-link" data-scroll-target="#can-we-use-the-bootstrap-to-compare-more-than-two-means"><span class="header-section-number">24.4.3</span> Can we use the bootstrap to compare more than two means?</a></li>
  </ul>
</li>
  <li>
<a href="#the-analysis-of-variance" id="toc-the-analysis-of-variance" class="nav-link" data-scroll-target="#the-analysis-of-variance"><span class="header-section-number">24.5</span> The Analysis of Variance</a>
  <ul class="collapse">
<li><a href="#the-oneway.test-approach" id="toc-the-oneway.test-approach" class="nav-link" data-scroll-target="#the-oneway.test-approach"><span class="header-section-number">24.5.1</span> The <code>oneway.test</code> approach</a></li>
  <li><a href="#using-the-aov-approach-and-the-summary-function" id="toc-using-the-aov-approach-and-the-summary-function" class="nav-link" data-scroll-target="#using-the-aov-approach-and-the-summary-function"><span class="header-section-number">24.5.2</span> Using the <code>aov</code> approach and the <code>summary</code> function</a></li>
  <li><a href="#using-the-anova-function-after-fitting-a-linear-model" id="toc-using-the-anova-function-after-fitting-a-linear-model" class="nav-link" data-scroll-target="#using-the-anova-function-after-fitting-a-linear-model"><span class="header-section-number">24.5.3</span> Using the <code>anova</code> function after fitting a linear model</a></li>
  </ul>
</li>
  <li>
<a href="#interpreting-the-anova-table" id="toc-interpreting-the-anova-table" class="nav-link" data-scroll-target="#interpreting-the-anova-table"><span class="header-section-number">24.6</span> Interpreting the ANOVA Table</a>
  <ul class="collapse">
<li><a href="#what-are-we-testing" id="toc-what-are-we-testing" class="nav-link" data-scroll-target="#what-are-we-testing"><span class="header-section-number">24.6.1</span> What are we Testing?</a></li>
  <li><a href="#elements-of-the-anova-table" id="toc-elements-of-the-anova-table" class="nav-link" data-scroll-target="#elements-of-the-anova-table"><span class="header-section-number">24.6.2</span> Elements of the ANOVA Table</a></li>
  <li><a href="#the-degrees-of-freedom" id="toc-the-degrees-of-freedom" class="nav-link" data-scroll-target="#the-degrees-of-freedom"><span class="header-section-number">24.6.3</span> The Degrees of Freedom</a></li>
  <li><a href="#the-sums-of-squares" id="toc-the-sums-of-squares" class="nav-link" data-scroll-target="#the-sums-of-squares"><span class="header-section-number">24.6.4</span> The Sums of Squares</a></li>
  <li><a href="#the-mean-square" id="toc-the-mean-square" class="nav-link" data-scroll-target="#the-mean-square"><span class="header-section-number">24.6.5</span> The Mean Square</a></li>
  <li><a href="#the-f-test-statistic-and-p-value" id="toc-the-f-test-statistic-and-p-value" class="nav-link" data-scroll-target="#the-f-test-statistic-and-p-value"><span class="header-section-number">24.6.6</span> The F Test Statistic and <em>p</em> Value</a></li>
  </ul>
</li>
  <li><a href="#the-residual-standard-error" id="toc-the-residual-standard-error" class="nav-link" data-scroll-target="#the-residual-standard-error"><span class="header-section-number">24.7</span> The Residual Standard Error</a></li>
  <li><a href="#the-proportion-of-variance-explained-by-the-factor" id="toc-the-proportion-of-variance-explained-by-the-factor" class="nav-link" data-scroll-target="#the-proportion-of-variance-explained-by-the-factor"><span class="header-section-number">24.8</span> The Proportion of Variance Explained by the Factor</a></li>
  <li>
<a href="#the-regression-approach-to-compare-population-means-based-on-independent-samples" id="toc-the-regression-approach-to-compare-population-means-based-on-independent-samples" class="nav-link" data-scroll-target="#the-regression-approach-to-compare-population-means-based-on-independent-samples"><span class="header-section-number">24.9</span> The Regression Approach to Compare Population Means based on Independent Samples</a>
  <ul class="collapse">
<li><a href="#interpreting-the-regression-output" id="toc-interpreting-the-regression-output" class="nav-link" data-scroll-target="#interpreting-the-regression-output"><span class="header-section-number">24.9.1</span> Interpreting the Regression Output</a></li>
  <li><a href="#the-full-anova-table" id="toc-the-full-anova-table" class="nav-link" data-scroll-target="#the-full-anova-table"><span class="header-section-number">24.9.2</span> The Full ANOVA Table</a></li>
  <li><a href="#anova-assumptions" id="toc-anova-assumptions" class="nav-link" data-scroll-target="#anova-assumptions"><span class="header-section-number">24.9.3</span> ANOVA Assumptions</a></li>
  </ul>
</li>
  <li><a href="#equivalent-approach-to-get-anova-results" id="toc-equivalent-approach-to-get-anova-results" class="nav-link" data-scroll-target="#equivalent-approach-to-get-anova-results"><span class="header-section-number">24.10</span> Equivalent approach to get ANOVA Results</a></li>
  <li>
<a href="#the-problem-of-multiple-comparisons" id="toc-the-problem-of-multiple-comparisons" class="nav-link" data-scroll-target="#the-problem-of-multiple-comparisons"><span class="header-section-number">24.11</span> The Problem of Multiple Comparisons</a>
  <ul class="collapse">
<li><a href="#the-bonferroni-solution" id="toc-the-bonferroni-solution" class="nav-link" data-scroll-target="#the-bonferroni-solution"><span class="header-section-number">24.11.1</span> The Bonferroni solution</a></li>
  <li><a href="#pairwise-comparisons-using-tukeys-hsd-method" id="toc-pairwise-comparisons-using-tukeys-hsd-method" class="nav-link" data-scroll-target="#pairwise-comparisons-using-tukeys-hsd-method"><span class="header-section-number">24.11.2</span> Pairwise Comparisons using Tukey’s HSD Method</a></li>
  <li><a href="#plotting-the-tukey-hsd-results" id="toc-plotting-the-tukey-hsd-results" class="nav-link" data-scroll-target="#plotting-the-tukey-hsd-results"><span class="header-section-number">24.11.3</span> Plotting the Tukey HSD results</a></li>
  </ul>
</li>
  <li><a href="#what-if-we-consider-another-outcome-bmi" id="toc-what-if-we-consider-another-outcome-bmi" class="nav-link" data-scroll-target="#what-if-we-consider-another-outcome-bmi"><span class="header-section-number">24.12</span> What if we consider another outcome, BMI?</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./18-testing_intro.html">Part B. Comparing Summaries</a></li><li class="breadcrumb-item"><a href="./24-anova.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Analysis of Variance</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="setup-packages-used-here" class="level2" data-number="24.1"><h2 data-number="24.1" class="anchored" data-anchor-id="setup-packages-used-here">
<span class="header-section-number">24.1</span> Setup: Packages Used Here</h2>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>comment <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggridges/">ggridges</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="national-youth-fitness-survey" class="level2" data-number="24.2"><h2 data-number="24.2" class="anchored" data-anchor-id="national-youth-fitness-survey">
<span class="header-section-number">24.2</span> National Youth Fitness Survey</h2>
<p>Recall the National Youth Fitness Survey, which we explored a small piece of in <a href="10-nnyfs_foundations.html" class="quarto-xref">Chapter&nbsp;<span>10</span></a>. We’ll look at a different part of the same survey here - specifically the 280 children whose data are captured in the <code>nyfs2</code> file.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyfs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/nyfs2.csv"</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nyfs2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 280 × 21
   subject_id sex    age_exam race_eth         english income_cat3 income_detail
        &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;        
 1      73228 Male          4 5 Other or Mult…       1 Low (below… 0 to 4999    
 2      72393 Male          4 2 Non-Hispanic …       1 Low (below… 0 to 4999    
 3      73303 Male          3 2 Non-Hispanic …       1 Low (below… 0 to 4999    
 4      72786 Male          5 1 Non-Hispanic …       1 Low (below… 0 to 4999    
 5      73048 Male          3 2 Non-Hispanic …       1 Low (below… 0 to 4999    
 6      72556 Female        4 2 Non-Hispanic …       1 Low (below… 0 to 4999    
 7      72580 Female        5 2 Non-Hispanic …       1 Low (below… 0 to 4999    
 8      72532 Female        4 4 Other Hispanic       0 Low (below… 0 to 4999    
 9      73012 Male          4 1 Non-Hispanic …       1 Low (below… 0 to 4999    
10      72099 Male          6 1 Non-Hispanic …       1 Low (below… 0 to 4999    
# ℹ 270 more rows
# ℹ 14 more variables: inc_to_pov &lt;dbl&gt;, weight_kg &lt;dbl&gt;, height_cm &lt;dbl&gt;,
#   bmi &lt;dbl&gt;, bmi_group &lt;dbl&gt;, bmi_cat &lt;chr&gt;, arm_length &lt;dbl&gt;,
#   arm_circ &lt;dbl&gt;, waist_circ &lt;dbl&gt;, calf_circ &lt;dbl&gt;, calf_skinfold &lt;dbl&gt;,
#   triceps_skinfold &lt;dbl&gt;, subscap_skinfold &lt;dbl&gt;, gmq &lt;dbl&gt;</code></pre>
</div>
</div>
</section><section id="comparing-gross-motor-quotient-scores-by-income-level-3-categories" class="level2" data-number="24.3"><h2 data-number="24.3" class="anchored" data-anchor-id="comparing-gross-motor-quotient-scores-by-income-level-3-categories">
<span class="header-section-number">24.3</span> Comparing Gross Motor Quotient Scores by Income Level (3 Categories)</h2>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyfs2a</span> <span class="op">&lt;-</span> <span class="va">nyfs2</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">subject_id</span>, <span class="va">income_cat3</span>, <span class="va">gmq</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">subject_id</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this first analysis, we’ll compare the population mean on the Gross Motor Quotient evaluation of these kids across three groups defined by income level. Higher values of this GMQ measure indicate improved levels of gross motor development, both in terms of locomotor and object control. See https://wwwn.cdc.gov/Nchs/Nnyfs/Y_GMX.htm for more details.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyfs2a</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income_cat3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu">mean</span><span class="op">(</span><span class="va">gmq</span><span class="op">)</span>, <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">median</a></span><span class="op">(</span><span class="va">gmq</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  income_cat3            n `mean(gmq)` `median(gmq)`
  &lt;chr&gt;              &lt;int&gt;       &lt;dbl&gt;         &lt;dbl&gt;
1 High (65K or more)    92        95.7            97
2 Low (below 25K)       98        97.0            97
3 Middle (25 - 64K)     90        95.4            94</code></pre>
</div>
</div>
<p>Uh, oh. We should rearrange those income categories to match a natural order from low to high.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyfs2a</span> <span class="op">&lt;-</span> <span class="va">nyfs2a</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>income_cat3 <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">income_cat3</span>, </span>
<span>         <span class="st">"Low (below 25K)"</span>, <span class="st">"Middle (25 - 64K)"</span>, <span class="st">"High (65K or more)"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When working with three independent samples, I use graphs analogous to those we built for two independent samples.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2a</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">income_cat3</span>, y <span class="op">=</span> <span class="va">gmq</span>, fill <span class="op">=</span> <span class="va">income_cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">income_cat3</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>notch <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.75</span>, width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"point"</span>, </span>
<span>               shape <span class="op">=</span> <span class="fl">23</span>, size <span class="op">=</span> <span class="fl">3</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, col <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GMQ Scores for 280 Children in NNYFS"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"GMQ Score, in points"</span>, x <span class="op">=</span> <span class="st">"Income Category"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="24-anova_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In addition to this comparison boxplot, we might consider faceted histograms.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2a</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gmq</span>, fill <span class="op">=</span> <span class="va">income_cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">income_cat3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="24-anova_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Or, if we want to ignore the (modest) sample size differences, we might consider density functions, perhaps through a ridgeline plot.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2a</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gmq</span>, y <span class="op">=</span> <span class="va">income_cat3</span>, fill <span class="op">=</span> <span class="va">income_cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"GMQ Score (in points) by Income Group"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"GMQ Score"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://wilkelab.org/ggridges/reference/theme_ridges.html">theme_ridges</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 4.7</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="24-anova_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span><span class="op">(</span><span class="va">nyfs2a</span><span class="op">$</span><span class="va">gmq</span>, <span class="va">nyfs2a</span><span class="op">$</span><span class="va">income_cat3</span>, <span class="va">favstats</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>nyfs2a$income_cat3: Low (below 25K)
 min Q1 median  Q3 max     mean       sd  n missing
  55 91     97 106 130 97.03061 14.79444 98       0
------------------------------------------------------------ 
nyfs2a$income_cat3: Middle (25 - 64K)
 min Q1 median  Q3 max     mean       sd  n missing
  67 85     94 106 136 95.36667 14.15123 90       0
------------------------------------------------------------ 
nyfs2a$income_cat3: High (65K or more)
 min Q1 median  Q3 max     mean       sd  n missing
  64 85     97 103 145 95.72826 14.49525 92       0</code></pre>
</div>
</div>
</section><section id="alternative-procedures-for-comparing-more-than-two-means" class="level2" data-number="24.4"><h2 data-number="24.4" class="anchored" data-anchor-id="alternative-procedures-for-comparing-more-than-two-means">
<span class="header-section-number">24.4</span> Alternative Procedures for Comparing More Than Two Means</h2>
<p>Now, if we only had two independent samples, we’d be choosing between a pooled t test, a Welch t test, and a non-parametric procedure like the Wilcoxon-Mann-Whitney rank sum test, or even perhaps a bootstrap alternative.</p>
<p>In the case of more than two independent samples, we have methods analogous to the Welch test, and the rank sum test, and even the bootstrap, but we’re going to be far more likely to select the <strong>analysis of variance</strong> (ANOVA) or an equivalent regression-based approach. These are the extensions of the pooled t test. Unless the sample outcome data are very clearly not Normally distributed, and no transformation is available which makes them appear approximately Normal in all of the groups we are comparing, we will stick with ANOVA.</p>
<section id="extending-the-welch-test-to-2-independent-samples" class="level3" data-number="24.4.1"><h3 data-number="24.4.1" class="anchored" data-anchor-id="extending-the-welch-test-to-2-independent-samples">
<span class="header-section-number">24.4.1</span> Extending the Welch Test to &gt; 2 Independent Samples</h3>
<p>It is possible to extend the Welch two-sample t test (not assuming equal population variances) into an analogous one-factor analysis for comparing population means based on independent samples from more than two groups.</p>
<p>If we want to compare the population mean GMQ levels across those three income groups without assuming equal population variances, <code>oneway.test</code> is up to the task. The hypotheses being tested here are:</p>
<ul>
<li>H0: All three means are the same vs.</li>
<li>HA: At least one of the population means is different than the others.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  gmq and income_cat3
F = 0.3416, num df = 2.00, denom df = 184.41, p-value = 0.7111</code></pre>
</div>
</div>
<p>We get a p value, but this isn’t much help, though, because we don’t have any measure of effect size, nor do we have any confidence intervals. Like the analogous Welch t test, this approach allows us to forego the assumption of equal population variances in each of the three income groups, but it still requires us to assume that the populations are Normally distributed.</p>
<p>That said, most of the time when we have more than two levels of the factor of interest, we won’t bother worrying about the equal population variance assumption, and will just use the one-factor ANOVA approach (with pooled variances) described below, to make the comparisons of interest.</p>
</section><section id="extending-the-rank-sum-test-to-2-independent-samples" class="level3" data-number="24.4.2"><h3 data-number="24.4.2" class="anchored" data-anchor-id="extending-the-rank-sum-test-to-2-independent-samples">
<span class="header-section-number">24.4.2</span> Extending the Rank Sum Test to &gt; 2 Independent Samples</h3>
<p>It is also possible to extend the Wilcoxon-Mann-Whitney two-sample test into an analogous one-factor analysis called the <strong>Kruskal-Wallis test</strong> for comparing population measures of location based on independent samples from more than two groups.</p>
<p>If we want to compare the centers of the distributions of population GMQ score across our three income groups without assuming Normality, we can use <code>kruskal.test</code>.</p>
<p>The hypotheses being tested here are still as before, but for a measure of location other than the population mean</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  gmq by income_cat3
Kruskal-Wallis chi-squared = 2.3202, df = 2, p-value = 0.3135</code></pre>
</div>
</div>
<p>Again, note that this isn’t much help, though, because we don’t have any measure of effect size, nor do we have any confidence intervals.</p>
<p>That said, most of the time when we have more than two levels of the factor of interest, we won’t bother worrying about potential violations of the Normality assumption unless they are glaring, and will just use the usual one-factor ANOVA approach (with pooled variances) described below, to make the comparisons of interest.</p>
</section><section id="can-we-use-the-bootstrap-to-compare-more-than-two-means" class="level3" data-number="24.4.3"><h3 data-number="24.4.3" class="anchored" data-anchor-id="can-we-use-the-bootstrap-to-compare-more-than-two-means">
<span class="header-section-number">24.4.3</span> Can we use the bootstrap to compare more than two means?</h3>
<p>Sure. There are both ANOVA and ANCOVA analogues using the bootstrap, and in fact, there are power calculations based on the bootstrap, too. If you want to see some example code, look at https://sammancuso.com/2017/11/01/model-based-bootstrapped-anova-and-ancova/</p>
</section></section><section id="the-analysis-of-variance" class="level2" data-number="24.5"><h2 data-number="24.5" class="anchored" data-anchor-id="the-analysis-of-variance">
<span class="header-section-number">24.5</span> The Analysis of Variance</h2>
<p>Extending the two-sample t test (assuming equal population variances) into a comparison of more than two samples uses the <strong>analysis of variance</strong> or ANOVA.</p>
<p>This is an analysis of a continuous outcome variable on the basis of a single categorical factor, in fact, it’s often called one-factor ANOVA or one-way ANOVA to indicate that the outcome is being split up into the groups defined by a single factor.</p>
<p>The null hypothesis is that the population means are all the same, and the alternative is that this is not the case. When there are just two groups, then this boils down to an F test that is equivalent to the Pooled t test.</p>
<section id="the-oneway.test-approach" class="level3" data-number="24.5.1"><h3 data-number="24.5.1" class="anchored" data-anchor-id="the-oneway.test-approach">
<span class="header-section-number">24.5.1</span> The <code>oneway.test</code> approach</h3>
<p>R will produce some elements of a one-factor ANOVA using the <code>oneway.test</code> command:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span>, var.equal<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means

data:  gmq and income_cat3
F = 0.34687, num df = 2, denom df = 277, p-value = 0.7072</code></pre>
</div>
</div>
<p>This isn’t the full analysis, though, which would require a more complete ANOVA table. There are two equivalent approaches to obtaining the full ANOVA table when comparing a series of 2 or more population means based on independent samples.</p>
</section><section id="using-the-aov-approach-and-the-summary-function" class="level3" data-number="24.5.2"><h3 data-number="24.5.2" class="anchored" data-anchor-id="using-the-aov-approach-and-the-summary-function">
<span class="header-section-number">24.5.2</span> Using the <code>aov</code> approach and the <code>summary</code> function</h3>
<p>Here’s one possible ANOVA table, which doesn’t require directly fitting a linear model.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
income_cat3   2    146   72.85   0.347  0.707
Residuals   277  58174  210.01               </code></pre>
</div>
</div>
</section><section id="using-the-anova-function-after-fitting-a-linear-model" class="level3" data-number="24.5.3"><h3 data-number="24.5.3" class="anchored" data-anchor-id="using-the-anova-function-after-fitting-a-linear-model">
<span class="header-section-number">24.5.3</span> Using the <code>anova</code> function after fitting a linear model</h3>
<p>An equivalent way to get identical results in a slightly different format runs the linear model behind the ANOVA approach directly.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: gmq
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income_cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
</div>
</div>
</section></section><section id="interpreting-the-anova-table" class="level2" data-number="24.6"><h2 data-number="24.6" class="anchored" data-anchor-id="interpreting-the-anova-table">
<span class="header-section-number">24.6</span> Interpreting the ANOVA Table</h2>
<section id="what-are-we-testing" class="level3" data-number="24.6.1"><h3 data-number="24.6.1" class="anchored" data-anchor-id="what-are-we-testing">
<span class="header-section-number">24.6.1</span> What are we Testing?</h3>
<p>The null hypothesis for the ANOVA table is that the population means of the outcome across the various levels of the factor of interest are all the same, against a two-sided alternative hypothesis that the level-specific population means are not all the same.</p>
<p>Specifically, if we have a grouping factor with <em>k</em> levels, then we are testing:</p>
<ul>
<li>H0: All k population means are the same.</li>
<li>HA: At least one of the population means is different from the others.</li>
</ul></section><section id="elements-of-the-anova-table" class="level3" data-number="24.6.2"><h3 data-number="24.6.2" class="anchored" data-anchor-id="elements-of-the-anova-table">
<span class="header-section-number">24.6.2</span> Elements of the ANOVA Table</h3>
<p>The ANOVA table breaks down the variation in the outcome explained by the k levels of the factor of interest, and the variation in the outcome which remains (the Residual, or Error).</p>
<p>Specifically, the elements of the ANOVA table are:</p>
<ol type="1">
<li>the degrees of freedom (labeled Df) for the factor of interest and for the Residuals</li>
<li>the sums of squares (labeled Sum Sq) for the factor of interest and for the Residuals</li>
<li>the mean square (labeled Mean Sq) for the factor of interest and for the Residuals</li>
<li>the ANOVA F test statistic (labeled F value), which is used to generate</li>
<li>the <em>p</em> value for the comparison assessed by the ANOVA model, labeled Pr(&gt;F)</li>
</ol></section><section id="the-degrees-of-freedom" class="level3" data-number="24.6.3"><h3 data-number="24.6.3" class="anchored" data-anchor-id="the-degrees-of-freedom">
<span class="header-section-number">24.6.3</span> The Degrees of Freedom</h3>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: gmq
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income_cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
</div>
</div>
<ul>
<li>The <strong>degrees of freedom</strong> attributable to the factor of interest (here, Income category) is the number of levels of the factor minus 1. Here, we have three Income categories (levels), so df(income_cat3) = 2.</li>
<li>The total degrees of freedom are the number of observations (across all levels of the factor) minus 1. We have 280 GMQ scores in the <code>nyfs2a</code> data, so the df(Total) must be 279, although the Total row isn’t shown by R in its output.</li>
<li>The Residual degrees of freedom are the Total df - Factor df. So, here, that’s 279 - 2 = 277.</li>
</ul></section><section id="the-sums-of-squares" class="level3" data-number="24.6.4"><h3 data-number="24.6.4" class="anchored" data-anchor-id="the-sums-of-squares">
<span class="header-section-number">24.6.4</span> The Sums of Squares</h3>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: gmq
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income_cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
</div>
</div>
<ul>
<li>The sum of squares (often abbreviated SS or Sum Sq) represents variation explained.</li>
<li>The factor SS is the sum across all levels of the factor of the sample size for the level multiplied by the squared difference between the level mean and the overall mean across all levels. Here, SS(<code>income_cat3</code>) = 146</li>
<li>The total SS is the sum across all observations of the square of the difference between the individual values and the overall mean. Here, that is 146 + 58174 = 58320</li>
<li>Residual SS = Total SS - Factor SS.</li>
<li>Also of interest is a calculation called <span class="math inline">\(\eta^2\)</span>, (“eta-squared”), which is equivalent to <span class="math inline">\(R^2\)</span> in a linear model.
<ul>
<li>SS(Factor) / SS(Total) = the proportion of variation in our outcome (here, GMQ) explained by the variation between groups (here, income groups)</li>
<li>In our case, <span class="math inline">\(\eta^2\)</span> = 146 / (146 + 58174) = 146 / 58320 = 0.0025</li>
<li>So, Income Category alone accounts for about 0.25% of the variation in GMQ levels observed in these data.</li>
</ul>
</li>
</ul></section><section id="the-mean-square" class="level3" data-number="24.6.5"><h3 data-number="24.6.5" class="anchored" data-anchor-id="the-mean-square">
<span class="header-section-number">24.6.5</span> The Mean Square</h3>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: gmq
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income_cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
</div>
</div>
<ul>
<li>The Mean Square is the Sum of Squares divided by the degrees of freedom, so MS(Factor) = SS(Factor)/df(Factor).</li>
<li>In our case, MS(<code>income_cat3</code>) = SS(<code>income_cat3</code>)/df(<code>income_cat3</code>) = 146 / 2 = 72.848 (notice that R maintains more decimal places than it shows for these calculations) and</li>
<li>MS(Residuals) = SS(Residuals) / df(Residuals) = 58174 / 277 = 210.014.
<ul>
<li>MS(Residuals) or MS(Error) is an estimate of the residual variance which corresponds to <span class="math inline">\(\sigma^2\)</span> in the underlying linear model for the outcome of interest, here <code>GMQ</code>.</li>
</ul>
</li>
</ul></section><section id="the-f-test-statistic-and-p-value" class="level3" data-number="24.6.6"><h3 data-number="24.6.6" class="anchored" data-anchor-id="the-f-test-statistic-and-p-value">
<span class="header-section-number">24.6.6</span> The F Test Statistic and <em>p</em> Value</h3>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: gmq
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income_cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
</div>
</div>
<ul>
<li>The ANOVA F test is obtained by calculating MS(Factor) / MS(Residuals). So in our case, F = 72.848 / 210.014 = 0.3469</li>
<li>The F test statistic is then compared to a specific F distribution to obtain a <em>p</em> value, which is shown here to be 0.7072</li>
<li>Specifically, the observed F test statistic is compared to an F distribution with numerator df = Factor df, and denominator df = Residual df to obtain the <em>p</em> value.
<ul>
<li>Here, we have SS(Factor) = 146 (approximately), and df(Factor) = 2, leaving MS(Factor) = 72.848</li>
<li>We have SS(Residual) = 58174, and df(Residual) = 277, leaving MS(Residual) = 210.014</li>
<li>MS(Factor) / MS(Residual) = F value = 0.3469, which, when compared to an F distribution with 2 and 277 degrees of freedom, yields a <em>p</em> value of 0.7072</li>
</ul>
</li>
</ul></section></section><section id="the-residual-standard-error" class="level2" data-number="24.7"><h2 data-number="24.7" class="anchored" data-anchor-id="the-residual-standard-error">
<span class="header-section-number">24.7</span> The Residual Standard Error</h2>
<p>The residual standard error is simply the square root of the variance estimate MS(Residual). Here, MS(Residual) = 210.014, so the Residual standard error = 14.49 points.</p>
</section><section id="the-proportion-of-variance-explained-by-the-factor" class="level2" data-number="24.8"><h2 data-number="24.8" class="anchored" data-anchor-id="the-proportion-of-variance-explained-by-the-factor">
<span class="header-section-number">24.8</span> The Proportion of Variance Explained by the Factor</h2>
<p>We will often summarize the proportion of the variation explained by the factor. The summary statistic is called eta-squared (<span class="math inline">\(\eta^2\)</span>), and is equivalent to the <span class="math inline">\(R^2\)</span> value we have seen previously in linear regression models.</p>
<p>Again, <span class="math inline">\(\eta^2\)</span> = SS(Factor) / SS(Total)</p>
<p>Here, we have - SS(<code>income_cat3</code>) = 146 and SS(Residuals) = 58174, so SS(Total) = 58320 - Thus, <span class="math inline">\(\eta^2\)</span> = SS(Factor)/SS(Total) = 146/58320 = 0.0025</p>
<p>The income category accounts for 0.25% of the variation in GMQ levels: only a tiny fraction.</p>
</section><section id="the-regression-approach-to-compare-population-means-based-on-independent-samples" class="level2" data-number="24.9"><h2 data-number="24.9" class="anchored" data-anchor-id="the-regression-approach-to-compare-population-means-based-on-independent-samples">
<span class="header-section-number">24.9</span> The Regression Approach to Compare Population Means based on Independent Samples</h2>
<p>This approach is equivalent to the ANOVA approach, and thus also (when there are just two samples to compare) to the pooled-variance t test. We run a linear regression model to predict the outcome (here, <code>GMQ</code>) on the basis of the categorical factor with three levels (here, <code>income_cat3</code>)</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data<span class="op">=</span><span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gmq ~ income_cat3, data = nyfs2a)

Residuals:
    Min      1Q  Median      3Q     Max 
-42.031  -9.031  -0.031   8.969  49.272 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     97.031      1.464  66.282   &lt;2e-16 ***
income_cat3Middle (25 - 64K)    -1.664      2.116  -0.786    0.432    
income_cat3High (65K or more)   -1.302      2.104  -0.619    0.536    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.49 on 277 degrees of freedom
Multiple R-squared:  0.002498,  Adjusted R-squared:  -0.004704 
F-statistic: 0.3469 on 2 and 277 DF,  p-value: 0.7072</code></pre>
</div>
</div>
<section id="interpreting-the-regression-output" class="level3" data-number="24.9.1"><h3 data-number="24.9.1" class="anchored" data-anchor-id="interpreting-the-regression-output">
<span class="header-section-number">24.9.1</span> Interpreting the Regression Output</h3>
<p>This output tells us many things, but for now, we’ll focus just on the coefficients output, which tells us that:</p>
<ul>
<li>the point estimate for the population mean GMQ score across “Low” income subjects is 97.03</li>
<li>the point estimate (sample mean difference) for the difference in population mean GMQ level between the “Middle” and “Low” income subjects is -1.66 (in words, the Middle income kids have lower GMQ scores than the Low income kids by 1.66 points on average.)</li>
<li>the point estimate (sample mean difference) for the difference in population mean GMQ level between the “High” and “Low” income subjects is -1.30 (in words, the High income kids have lower GMQ scores than the Low income kids by 1.30 points on average.)</li>
</ul>
<p>Of course, we knew all of this already from a summary of the sample means.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyfs2a</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">income_cat3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu">mean</span><span class="op">(</span><span class="va">gmq</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  income_cat3            n `mean(gmq)`
  &lt;fct&gt;              &lt;int&gt;       &lt;dbl&gt;
1 Low (below 25K)       98        97.0
2 Middle (25 - 64K)     90        95.4
3 High (65K or more)    92        95.7</code></pre>
</div>
</div>
<p>The model for predicting GMQ is based on two binary (1/0) indicator variables, specifically, we have:</p>
<ul>
<li>Estimated GMQ = 97.03 - 1.66 x [1 if Middle income or 0 if not] - 1.30 x [1 if High income or 0 if not]</li>
</ul>
<p>The coefficients section also provides a standard error and t statistic and two-sided <em>p</em> value for each coefficient.</p>
</section><section id="the-full-anova-table" class="level3" data-number="24.9.2"><h3 data-number="24.9.2" class="anchored" data-anchor-id="the-full-anova-table">
<span class="header-section-number">24.9.2</span> The Full ANOVA Table</h3>
<p>To see the full ANOVA table corresponding to any linear regression model, we run…</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data<span class="op">=</span><span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: gmq
             Df Sum Sq Mean Sq F value Pr(&gt;F)
income_cat3   2    146  72.848  0.3469 0.7072
Residuals   277  58174 210.014               </code></pre>
</div>
</div>
</section><section id="anova-assumptions" class="level3" data-number="24.9.3"><h3 data-number="24.9.3" class="anchored" data-anchor-id="anova-assumptions">
<span class="header-section-number">24.9.3</span> ANOVA Assumptions</h3>
<p>The assumptions behind analysis of variance are the same as those behind a linear model. Of specific interest are:</p>
<ul>
<li>The samples obtained from each group are independent.</li>
<li>Ideally, the samples from each group are a random sample from the population described by that group.</li>
<li>In the population, the variance of the outcome in each group is equal. (This is less of an issue if our study involves a balanced design.)</li>
<li>In the population, we have Normal distributions of the outcome in each group.</li>
</ul>
<p>Happily, the F test is fairly robust to violations of the Normality assumption.</p>
</section></section><section id="equivalent-approach-to-get-anova-results" class="level2" data-number="24.10"><h2 data-number="24.10" class="anchored" data-anchor-id="equivalent-approach-to-get-anova-results">
<span class="header-section-number">24.10</span> Equivalent approach to get ANOVA Results</h2>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
income_cat3   2    146   72.85   0.347  0.707
Residuals   277  58174  210.01               </code></pre>
</div>
</div>
<p>So which of the pairs of means are driving the differences we see?</p>
</section><section id="the-problem-of-multiple-comparisons" class="level2" data-number="24.11"><h2 data-number="24.11" class="anchored" data-anchor-id="the-problem-of-multiple-comparisons">
<span class="header-section-number">24.11</span> The Problem of Multiple Comparisons</h2>
<ol type="1">
<li>Suppose we compare High to Low, using a test with <span class="math inline">\(\alpha\)</span> = 0.05</li>
<li>Then we compare Middle to Low on the same outcome, also using <span class="math inline">\(\alpha\)</span> = 0.05</li>
<li>Then we compare High to Middle, also with <span class="math inline">\(\alpha\)</span> = 0.05</li>
</ol>
<p>What is our overall <span class="math inline">\(\alpha\)</span> level across these three comparisons?</p>
<ul>
<li>It could be as bad as 0.05 + 0.05 + 0.05, or 0.15.</li>
<li>Rather than our nominal 95% confidence, we have something as low as 85% confidence across this set of simultaneous comparisons.</li>
</ul>
<section id="the-bonferroni-solution" class="level3" data-number="24.11.1"><h3 data-number="24.11.1" class="anchored" data-anchor-id="the-bonferroni-solution">
<span class="header-section-number">24.11.1</span> The Bonferroni solution</h3>
<ol type="1">
<li>Suppose we compare High to Low, using a test with <span class="math inline">\(\alpha\)</span> = 0.05/3</li>
<li>Then we compare Middle to Low on the same outcome, also using <span class="math inline">\(\alpha\)</span> = 0.05/3</li>
<li>Then we compare High to Middle, also with <span class="math inline">\(\alpha\)</span> = 0.05/3</li>
</ol>
<p>Then across these three comparisons, our overall <span class="math inline">\(\alpha\)</span> can be (at worst)</p>
<ul>
<li>0.05/3 + 0.05/3 + 0.05/3 = 0.05</li>
<li>So by changing our nominal confidence level from 95% to 98.333% in each comparison, we wind up with at least 95% confidence across this set of simultaneous comparisons.</li>
<li>This is a conservative (worst case) approach.</li>
</ul>
<p>Goal: Simultaneous comparisons of White vs AA, AA vs Other and White vs Other</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test</a></span><span class="op">(</span><span class="va">nyfs2a</span><span class="op">$</span><span class="va">gmq</span>, <span class="va">nyfs2a</span><span class="op">$</span><span class="va">income_cat3</span>, p.adjust<span class="op">=</span><span class="st">"bonferroni"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  nyfs2a$gmq and nyfs2a$income_cat3 

                   Low (below 25K) Middle (25 - 64K)
Middle (25 - 64K)  1               -                
High (65K or more) 1               1                

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<p>These <em>p</em> values are very large.</p>
</section><section id="pairwise-comparisons-using-tukeys-hsd-method" class="level3" data-number="24.11.2"><h3 data-number="24.11.2" class="anchored" data-anchor-id="pairwise-comparisons-using-tukeys-hsd-method">
<span class="header-section-number">24.11.2</span> Pairwise Comparisons using Tukey’s HSD Method</h3>
<p>Goal: Simultaneous (less conservative) confidence intervals and <em>p</em> values for our three pairwise comparisons (High vs.&nbsp;Low, High vs.&nbsp;Middle, Middle vs.&nbsp;Low)</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = gmq ~ income_cat3, data = nyfs2a)

$income_cat3
                                           diff       lwr      upr     p adj
Middle (25 - 64K)-Low (below 25K)    -1.6639456 -6.649518 3.321627 0.7116745
High (65K or more)-Low (below 25K)   -1.3023514 -6.259595 3.654892 0.8098084
High (65K or more)-Middle (25 - 64K)  0.3615942 -4.701208 5.424396 0.9845073</code></pre>
</div>
</div>
</section><section id="plotting-the-tukey-hsd-results" class="level3" data-number="24.11.3"><h3 data-number="24.11.3" class="anchored" data-anchor-id="plotting-the-tukey-hsd-results">
<span class="header-section-number">24.11.3</span> Plotting the Tukey HSD results</h3>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="24-anova_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that the default positioning of the y axis in the plot of Tukey HSD results can be problematic. If we have longer names, in particular, for the levels of our factor, R will leave out some of the labels. We can alleviate that problem either by using the <code>fct_recode</code> function in the <code>forcats</code> package to rename the factor levels, or we can use the following code to reconfigure the margins of the plot.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mar.default</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="co"># save default plotting margins</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="va">mar.default</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">gmq</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2a</span><span class="op">)</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="24-anova_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="va">mar.default</span><span class="op">)</span> <span class="co"># return to normal plotting margins</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="what-if-we-consider-another-outcome-bmi" class="level2" data-number="24.12"><h2 data-number="24.12" class="anchored" data-anchor-id="what-if-we-consider-another-outcome-bmi">
<span class="header-section-number">24.12</span> What if we consider another outcome, BMI?</h2>
<p>We’ll look at the full data set in <code>nyfs2</code> now, so we can look at BMI as a function of income.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyfs2</span><span class="op">$</span><span class="va">income_cat3</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">nyfs2</span><span class="op">$</span><span class="va">income_cat3</span>,</span>
<span>                <span class="st">"Low (below 25K)"</span>, <span class="st">"Middle (25 - 64K)"</span>, <span class="st">"High (65K or more)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bmi</span>, y <span class="op">=</span> <span class="va">income_cat3</span>, fill <span class="op">=</span> <span class="va">income_cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html">geom_density_ridges</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Body-Mass Index by Income Group"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Body-Mass Index"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://wilkelab.org/ggridges/reference/theme_ridges.html">theme_ridges</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="24-anova_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nyfs2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">income_cat3</span>, y <span class="op">=</span> <span class="va">bmi</span>, fill <span class="op">=</span> <span class="va">income_cat3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">income_cat3</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span>, notch <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"point"</span>, </span>
<span>               shape <span class="op">=</span> <span class="fl">23</span>, size <span class="op">=</span> <span class="fl">3</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span>, col <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"BMI for 280 Children in NNYFS"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Body-Mass Index"</span>, x <span class="op">=</span> <span class="st">"Income Category"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="24-anova_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here are the descriptive numerical summaries:</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">favstats</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         income_cat3  min     Q1 median   Q3  max     mean       sd  n missing
1    Low (below 25K) 13.8 15.500  16.50 17.9 25.2 16.98163 2.194574 98       0
2  Middle (25 - 64K) 13.7 15.225  16.05 16.9 24.1 16.37111 1.898920 90       0
3 High (65K or more) 13.8 15.300  15.85 17.2 21.8 16.27065 1.614395 92       0</code></pre>
</div>
</div>
<p>Here is the ANOVA table.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">income_cat3</span>, data <span class="op">=</span> <span class="va">nyfs2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: bmi
             Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
income_cat3   2   28.32 14.1583  3.8252 0.02298 *
Residuals   277 1025.26  3.7013                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Let’s consider the Tukey HSD results. First, we’ll create a factor with shorter labels.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nyfs2</span><span class="op">$</span><span class="va">inc.new</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">nyfs2</span><span class="op">$</span><span class="va">income_cat3</span>, </span>
<span>               <span class="st">"Low"</span> <span class="op">=</span> <span class="st">"Low (below 25K)"</span>, <span class="st">"Middle"</span> <span class="op">=</span> <span class="st">"Middle (25 - 64K)"</span>,</span>
<span>               <span class="st">"High"</span> <span class="op">=</span> <span class="st">"High (65K or more)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">inc.new</span>, data <span class="op">=</span> <span class="va">nyfs2</span><span class="op">)</span>,</span>
<span>                  conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="24-anova_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It appears that there is a detectable difference between the <code>bmi</code> means of the “Low” group and both the “High” and “Middle” group at the 90% confidence level, but no detectable difference between “Middle” and “High.” Details of those confidence intervals for those pairwise comparisons follow.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">inc.new</span>, data <span class="op">=</span> <span class="va">nyfs2</span><span class="op">)</span>,</span>
<span>                  conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    90% family-wise confidence level

Fit: aov(formula = bmi ~ inc.new, data = nyfs2)

$inc.new
                  diff        lwr         upr     p adj
Middle-Low  -0.6105215 -1.1893722 -0.03167084 0.0775491
High-Low    -0.7109805 -1.2865420 -0.13541892 0.0306639
High-Middle -0.1004589 -0.6882764  0.48735849 0.9339289</code></pre>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./23-examples_2means.html" class="pagination-link" aria-label="Two Examples Comparing Means">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Two Examples Comparing Means</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./25-one_proportion.html" class="pagination-link" aria-label="Estimating a Population Proportion">
        <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Estimating a Population Proportion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>